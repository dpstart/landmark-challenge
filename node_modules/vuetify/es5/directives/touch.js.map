{"version":3,"sources":["../../src/directives/touch.js"],"names":[],"mappings":"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","sourcesContent":["const touchstart = (event, wrapper) => {\n  const touch = event.changedTouches[0]\n  wrapper.touchstartX = touch.clientX\n  wrapper.touchstartY = touch.clientY\n\n  wrapper.start &&\n    wrapper.start(Object.assign(event, wrapper))\n}\n\nconst touchend = (event, wrapper) => {\n  const touch = event.changedTouches[0]\n  wrapper.touchendX = touch.clientX\n  wrapper.touchendY = touch.clientY\n\n  wrapper.end &&\n    wrapper.end(Object.assign(event, wrapper))\n\n  handleGesture(wrapper)\n}\n\nconst touchmove = (event, wrapper) => {\n  const touch = event.changedTouches[0]\n  wrapper.touchmoveX = touch.clientX\n  wrapper.touchmoveY = touch.clientY\n\n  wrapper.move && wrapper.move(Object.assign(event, wrapper))\n}\n\nconst handleGesture = wrapper => {\n  const { touchstartX, touchendX, touchstartY, touchendY } = wrapper\n  const dirRatio = 0.5\n  const minDistance = 16\n  wrapper.offsetX = touchendX - touchstartX\n  wrapper.offsetY = touchendY - touchstartY\n\n  if (Math.abs(wrapper.offsetY) < dirRatio * Math.abs(wrapper.offsetX)) {\n    wrapper.left && (touchendX < touchstartX - minDistance) && wrapper.left(wrapper)\n    wrapper.right && (touchendX > touchstartX + minDistance) && wrapper.right(wrapper)\n  }\n\n  if (Math.abs(wrapper.offsetX) < dirRatio * Math.abs(wrapper.offsetY)) {\n    wrapper.up && (touchendY < touchstartY - minDistance) && wrapper.up(wrapper)\n    wrapper.down && (touchendY > touchstartY + minDistance) && wrapper.down(wrapper)\n  }\n}\n\nfunction inserted (el, { value }, { context }) {\n  const wrapper = {\n    touchstartX: 0,\n    touchstartY: 0,\n    touchendX: 0,\n    touchendY: 0,\n    touchmoveX: 0,\n    touchmoveY: 0,\n    offsetX: 0,\n    offsetY: 0,\n    left: value.left,\n    right: value.right,\n    up: value.up,\n    down: value.down,\n    start: value.start,\n    move: value.move,\n    end: value.end\n  }\n\n  const target = value.parent ? el.parentNode : el\n  const options = value.options || { passive: true }\n\n  // Needed to pass unit tests\n  if (!target) return\n\n  const handlers = {\n    touchstart: e => touchstart(e, wrapper),\n    touchend: e => touchend(e, wrapper),\n    touchmove: e => touchmove(e, wrapper)\n  }\n  target._touchHandlers = Object.assign(Object(target._touchHandlers), {\n    [context._uid]: handlers\n  })\n  for (const eventName of Object.keys(handlers)) {\n    target.addEventListener(eventName, handlers[eventName], options)\n  }\n}\n\nfunction unbind (el, { value }, { context }) {\n  const target = value.parent ? el.parentNode : el\n\n  if (!target) return\n\n  const handlers = target._touchHandlers[context._uid]\n  for (const eventName of Object.keys(handlers)) {\n    target.removeEventListener(eventName, handlers[eventName])\n  }\n  delete target._touchHandlers[context._uid]\n}\n\nexport default {\n  name: 'touch',\n  inserted,\n  unbind\n}\n"],"sourceRoot":""}